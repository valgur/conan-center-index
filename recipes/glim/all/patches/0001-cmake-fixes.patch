--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -4,4 +4,6 @@
-add_compile_options(-std=c++17)
+if(NOT DEFINED CMAKE_CXX_STANDARD)
+  set(CMAKE_CXX_STANDARD 17)
+endif()
 set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_LIST_DIR}/cmake")
 
 if(NOT CMAKE_BUILD_TYPE AND NOT CMAKE_CONFIGURATION_TYPES)
@@ -15,10 +17,8 @@
 option(BUILD_WITH_MARCH_NATIVE "Build with -march=native" OFF)
 
 if(BUILD_WITH_MARCH_NATIVE)
-  add_definitions(-march=native)
+  add_compile_options(-march=native)
   add_definitions(-DBUILD_WITH_MARCH_NATIVE)
-  set(CMAKE_C_FLAGS "-march=native ${CMAKE_C_FLAGS}")
-  set(CMAKE_CXX_FLAGS "-march=native ${CMAKE_CXX_FLAGS}")
 endif()
 
 find_package(Boost REQUIRED serialization)
@@ -28,6 +28,7 @@
 find_package(gtsam_points REQUIRED)
 find_package(OpenMP REQUIRED)
 find_package(spdlog REQUIRED)
+find_package(nlohmann_json REQUIRED)
 
 if(BUILD_WITH_VIEWER)
   find_package(Iridescence REQUIRED)
@@ -85,7 +86,6 @@
 )
 target_include_directories(glim PUBLIC
   $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
-  $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/thirdparty/json/include>
   $<INSTALL_INTERFACE:include/glim>
   ${OpenCV_INCLUDE_DIRS}
 )
@@ -97,6 +97,7 @@
   gtsam_points::gtsam_points
   OpenMP::OpenMP_CXX
   spdlog::spdlog
+  nlohmann_json::nlohmann_json
   $<TARGET_NAME_IF_EXISTS:Iridescence::Iridescence>
   ${OpenCV_LIBRARIES}
 )
